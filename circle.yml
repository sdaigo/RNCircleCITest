machine:
  xcode:
    version: 8.3.3

dependencies:
  override:
    - brew install node@6
    - bundle check --path=vendor/bundle || bundle install --path=vendor/bundle --jobs=4 --retry=3 --without development
  cache_directories:
    - node_modules
    - vendor/bundle

deployment:
  preview:
    branch: preview-markdown
    commands:
      - cd ios && bundle exec fastlane test

  release:
    branch: master
    commands:
      - cd ios && bundle exec fastlane release
